---
title: "Yelp Dataset"
output: html_document
editor_options: 
  chunk_output_type: inline
---
## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
businessdata <- read.csv("/Users/moshihathiyaageswaran/Downloads/Yelp Dataset Business.csv")
```

```{r}
head(businessdata)
```

```{r}
str(businessdata)
```

```{r}
summary(businessdata)
```

```{r}
#Filter state for BC
businessdata <- businessdata[c("business_id", "city", "state", "stars", "review_count", "is_open", "categories")]
businessdataa <- businessdata[businessdata$state == "BC",]
businessdataa
```

```{r}
#Filter business for open
businessData <- businessdataa[businessdataa$is_open == "1", ]
businessData
```

```{r}
#Filter data for restaurants
library(dplyr)
businessData %>%
  select(business_id, city, state, stars, review_count, is_open, categories) %>% 
  filter(grepl('Restaurants', categories))
```

```{r}
reviewdata <- read.csv("/Users/moshihathiyaageswaran/Downloads/Yelp Dataset Review.csv")
```

```{r}
summary(reviewdata)
```

```{r}
#Filter data for recent reviews (2018)
library(dplyr)
reviewdata <- reviewdata[c("review_id", "business_id", "stars", "date", "text")]
reviewData <- reviewdata %>% filter(grepl('2018',date))
```

```{r}
#Create one dataset with all the features that were extracted from the original dataset
library(dplyr)
yelpdataset <- merge(businessData, reviewData)
yelpdataset
```
```{r}
write.csv(yelpdataset,"/Users/moshihathiyaageswaran/Downloads/Yelp Dataset.csv")
```

```{r}
#Identify the amount of different cities within British Columbia 
city <- unique(yelpdataset$city)
length(city)
city
```

```{r}
#Identify the amount of different businesses within British Columbia 
businessID <- data.frame(unique(yelpdataset$business_id))
businessID
```
```{r}
#Create a dataframe with the unique businesses and their corresponding review count
businessID <- rep(c(yelpdataset$business_id))
reviewCount <- rep(c(yelpdataset$review_count))
City <- rep(c(yelpdataset$city))
Stars <- rep(c(yelpdataset$stars))
df <- data.frame(businessID,reviewCount,City, Stars)
yelp <- unique(df[c("businessID","reviewCount", "City", "Stars")])
yelp
```
```{r}
#Rearranging the data to identify the businesses with the highest review count
library(dplyr)
yelpp <- yelp %>% arrange(desc(reviewCount)) 
yelpp
```

```{r}
yelp2 <- yelpp[order(yelpp$City),]
yelp2
```
```{r}
#Uncover the relationship between review count and stars. It is understood that customers are more likely to leave a review when they have a good experience with a restaurant which is reflected through the star rating. This helps us identify the correlation between review count and stars, a greater amount of review counts are directly related to a higher overall star rating. 
plot(yelp2$reviewCount, yelp2$Stars, main = "Relationship Between Review Count and Stars", xlab = "Review Count", ylab = "Stars")
```

```{r}
#Boxplot for numerical attributes 
#For the purpose of this research, outliers will not be a concern. 
par(mfcol=c(2,1))
boxplot(yelp$reviewCount, horizontal = TRUE, outline = TRUE, main = "Boxplot for Review Count")
boxplot(yelp$Stars, horizontal = TRUE, outline = TRUE, main = "Boxplot for Stars")
```
